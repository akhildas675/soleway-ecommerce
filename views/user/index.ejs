<!DOCTYPE html>
<html lang="en">

<head>
	<title>Soleway</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<%- include('./partials/solewayCss.ejs') %>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
		<link rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.9.1/font/bootstrap-icons.min.css">
		<style>
			.btn-small {
				padding: 5px 10px;
				font-size: 12px;
				line-height: 1.5;
				border-radius: 3px;
				display: inline-flex;
				align-items: center;
			}

			.btn-small i {
				margin-right: 5px;
			}

			/* Default state for the wishlist button */
			.btn-addwish-b2 {
  border: 1px solid transparent;
  background-color: transparent;
  cursor: pointer;
  transition: all 0.3s ease;
}

/* Default heart icon color (not active) */
.btn-addwish-b2 .bi-heart {
  color: grey; /* Default color for outline heart */
}

/* Active state: When the product is in the wishlist */
.btn-addwish-b2.active {
  background-color: rgb(255, 255, 255); /* Change the button background to red when active */
  border-color: rgb(255, 255, 255);
}

/* Active heart icon (filled heart) */
.btn-addwish-b2.active .bi-heart-fill {
  color: rgb(253, 0, 0); /* Change the heart icon to white when active */
}

/* Active state hover effect (optional) */
.btn-addwish-b2.active:hover {
  transform: scale(1.1); /* Enlarge button slightly on hover */
}

/* Heart icon inside the button (when not active) */
.btn-addwish-b2 .bi-heart {
  transition: color 0.3s ease;
}

/* Heart icon inside the button (when active) */
.btn-addwish-b2.active .bi-heart,
.btn-addwish-b2.active .bi-heart-fill {
  transition: color 0.3s ease;
}

		</style>
		
		
</head>

<body class="animsition">

	<!-- Header -->
	<header>
		<!-- Header desktop -->
		<div class="container-menu-desktop">
			<!-- Topbar -->
			<%- include('./partials/solewayTopBar.ejs') %>



				<!-- Top bar end -->

				<div class="wrap-menu-desktop">
					<nav class="limiter-menu-desktop container">

						<!-- Logo desktop -->
						<a href="/" class="logo">
							<img src="/images/icons/1.png" alt="IMG-LOGO">
						</a>

						<!-- Menu desktop -->
						<div class="menu-desktop">
							<ul class="main-menu">
								<li class="active-menu">
									<a href="/" style="text-decoration: none;">Home</a>


								</li>
								

								<li>
									<a href="/Shop" style="text-decoration: none;">Shop</a>
								</li>

								
								<li>
									<a href="/Blog" style="text-decoration: none;">Blog</a>
								</li>

								<li>
									<a href="/About" style="text-decoration: none;">About</a>
								</li>

								<li>
									<a href="/Contact" style="text-decoration: none;">Contact</a>
								</li>
							</ul>
						</div>

						<!-- Icon header -->
						<div class="wrap-icon-header flex-w flex-r-m">
							<!-- <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-modal-search">
								<i class="zmdi zmdi-search"></i>
							</div> -->

					
                        </div>

						
						<% if (findUser) { %> <!-- Only check if user is logged in -->
							<a href="/Cart" 
							   class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart" 
							   data-notify="<%= cartCount > 0 ? cartCount : 0 %>">
								<i class="zmdi zmdi-shopping-cart"></i>
								
							</a>
						
							<a href="/Wishlist" 
							   class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti" 
							   data-notify="<%= wishlistCount > 0 ? wishlistCount : 0 %>">
								<i class="zmdi zmdi-favorite-outline"></i>
								
							</a>
						<% } %>
						
						</div>
					</nav>
				</div>
		</div>

		<!-- Header Mobile -->
		<div class="wrap-header-mobile">
			<!-- Logo mobile -->
			<div class="logo-mobile">
				<a href="/"><img src="/images/icons/1.png" alt="IMG-LOGO"></a>
			</div>

			<!-- Icon header -->
			<div class="wrap-icon-header flex-w flex-r-m m-r-15">
				<!-- <div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 js-show-modal-search">
					<i class="zmdi zmdi-search"></i>
				</div> -->

				<!-- <div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart" data-notify="2">
                    <i class="zmdi zmdi-shopping-cart"></i>
                </div> -->

				<% if (cartCount > 0 && findUser && wishlistCount) { %> <!-- Use cartCount instead of locals.cartCount -->
					<a href="/Cart"
					  class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart"
					  data-notify="<%= cartCount > 0 ? cartCount : 0  %>">
					  <i class="zmdi zmdi-shopping-cart"></i>
					</a>
				  
				  

					<a href="/Wishlist"
						class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 icon-header-noti"
						data-notify="<%= wishlistCount > 0 ? wishlistCount : 0 %>">
						<i class="zmdi zmdi-favorite-outline"></i>
					</a>
					<% } %>
			</div>

			<!-- Button show menu -->
			<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</div>
		</div>

		<!-- Menu Mobile -->
		<div class="menu-mobile">
			
			<ul class="main-menu-m" >
				<li class="active-menu">
					<a href="/" style="text-decoration: none;">Home</a>
					
					
				</li>

				<li>
					<a href="/Shop" style="text-decoration: none;">Shop</a>
				</li>

				

				<li>
					<a href="/Blog"  style="text-decoration: none;">Blog</a>
				</li>

				<li>
					<a href="/About" style="text-decoration: none;">About</a>
				</li>

				<li>
					<a href="/Contact" style="text-decoration: none;">Contact</a>
				</li>
				<li>
					<a href="/Account" style="text-decoration: none;">Account</a>

				</li>

				
				<% if (locals.findUser) { %>
					<li>
						<a href="/logout" style="text-decoration: none;">Logout</a>
	
					</li>
					<% } else { %>
						<li>
							<a href="/Login" style="text-decoration: none;">Login</a>
		
						</li>
						<li>
							<a href="/Register" style="text-decoration: none;">Register</a>
		
						</li>

						
						<% } %>




			</ul>
		</div>

		<!-- Modal Search -->

		<% if (locals.products) { %>


			<div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
				<div class="container-search-header">
					<button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
						<img src="images/icons/icon-close2.png" alt="CLOSE">
					</button>

					<form class="wrap-search-header flex-w p-l-15">
						<button class="flex-c-m trans-04">
							<i class="zmdi zmdi-search"></i>
						</button>
						<input class="plh3" type="text" name="search" placeholder="Search...">
					</form>
				</div>
			</div>
			<% } %>
	</header>

	<!-- Cart -->



	<!-- Slider -->
	<section class="section-slide">
		<div class="wrap-slick1">
			<div class="slick1">
				<div class="item-slick1" style="background-image: url(/images/Designer\ \(11\).jpeg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="fadeInDown" data-delay="0">
								<span class="ltext-101 cl2 respon2">
									NEW Collection 2024
								</span>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="fadeInUp" data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									SANDALS
								</h2>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="zoomIn" data-delay="1600">
								<a href="/Shop"
									class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>

				<!-- <div class="item-slick1" style="background-image: url(/images/Designer\ \(1\).jpeg);"> -->

				<div class="item-slick1" style="background-image: url(images/Designer.jpeg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="rollIn" data-delay="0">
								<span class="ltext-101 cl2 respon2">
									New-Season
								</span>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="lightSpeedIn"
								data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									SNEAKERS
								</h2>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="slideInUp" data-delay="1600">
								<a href="/Shop"
									class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>

				<div class="item-slick1" style="background-image: url(/images/Designer\ \(12\).jpeg);">
					<div class="container h-full">
						<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
							<div class="layer-slick1 animated visible-false" data-appear="rotateInDownLeft"
								data-delay="0">
								<span class="ltext-101 cl2 respon2">
									NEW ARRIVALS
								</span>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="rotateInUpRight"
								data-delay="800">
								<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1">
									LOAFERS
								</h2>
							</div>

							<div class="layer-slick1 animated visible-false" data-appear="rotateIn" data-delay="1600">
								<a href="/Shop"
									class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
									Shop Now
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>


	<!-- Banner -->
	<div class="sec-banner bg0 p-t-80 p-b-50">
		<div class="container">
			<h3 class="ltext-103 cl5">
				NEW ARRIVALS
			</h3>
			<div class="row">
				<% if (locals.newArrival) { %>
					<% for( let i=0; i < newArrival.length; i++ ) { %>
	
						<div class="col-md-6 col-xl-4 p-b-30 m-lr-auto">
							<!-- Bootstrap Carousel for each product -->
							<div id="carousel<%= i %>" class="carousel slide" data-bs-ride="carousel">
								<div class="carousel-inner">
									<% for (let j = 0; j < newArrival[i].images.length; j++) { %>
										<div class="carousel-item <%= j === 0 ? 'active' : '' %>">
											<img src="<%= newArrival[i].images[j] %>" class="d-block w-100" alt="Product Image">
										</div>
									<% } %>
								</div>
	
								<!-- Optional: Add Previous/Next controls -->
								<a class="carousel-control-prev" href="#carousel<%= i %>" role="button" data-bs-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Previous</span>
								</a>
								<a class="carousel-control-next" href="#carousel<%= i %>" role="button" data-bs-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Next</span>
								</a>
							</div>
	
							<!-- Product Details -->
							<a href="/productView?id=<%= newArrival[i]._id %>" class="block1-txt ab-t-l s-full flex-col-l-sb p-lr-38 p-tb-34 trans-03 respon3" style="text-decoration: none;">
								<div class="block1-txt-child1 flex-col-l">
									<span class="block1-name ltext-102 trans-04 p-b-8" style="text-decoration: none; color: rgb(68, 68, 68);">
										<%= newArrival[i].productName %>
									</span>
							
									<span class="block1-info stext-102 trans-04">
										Spring 2024
									</span>
								</div>
							
								<div class="block1-txt-child2 p-b-4 trans-05">
									<div class="block1-link stext-101 cl0 trans-09">
										Shop Now
									</div>
								</div>
							</a>
						</div>
						
					<% } %>
				<% } %>
			</div>
		</div>
	</div>
	

	<!-- Product -->
	<section class="bg0 p-t-23 p-b-140">
		<div class="container">
			<div class="p-b-10">
				<h3 class="ltext-103 cl5">
					Product Overview
				</h3>
			</div>

			<div class="flex-w flex-sb-m p-b-52">
				

					
			</div>





			<div class="row isotope-grid">
				<% if (locals.products) { %>
					<% for (let i = 0; i < products.length; i++) { %>
						<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item women">
							<!-- Block2 -->
							<div class="block2">
								<div class="block2-pic hov-img0">
									<a href="/productView?id=<%= products[i]._id %>">
										<img src="../<%= products[i].images[0] %>" alt="IMG-PRODUCT">
									</a>
								</div>
			
								<div class="block2-txt flex-w flex-t p-t-14">
									<div class="block2-txt-child1 flex-col-l">
										<a href="/productView?id=<%= products[i]._id %>"
											class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6"
											style="text-decoration: none;">
											<%= products[i].productName %>
										</a>
			
										<span class="stext-105 cl3">
											Price: â‚¹ 
											<%= (products[i].offerPrice && products[i].offerPrice > 0) ? products[i].offerPrice : products[i].realPrice %>
										</span>
									</div>
			
									<!-- Product Wishlist Button -->
									<% if (locals.findUser) { %>
										<div class="block2-txt-child2 flex-r p-t-3">
											
											<a class="btn-addwish-b2 dis-block pos-relative js-addwish-b2 <%= wishlist.includes(products[i]._id.toString()) ? 'active' : '' %>" 
												data-product-id="<%= products[i]._id %>" 
												onclick="toggleWishList('<%= products[i]._id %>')">
												
												<% if (wishlist.includes(products[i]._id.toString())) { %>
												
													<i class="bi bi-heart-fill"></i>
												<% } else { %>
												
													<i class="bi bi-heart"></i>
												<% } %>
											</a>
										</div>
									<% } else { %>
										<div class="block2-txt-child2 flex-r p-t-3">
											
										</div>
									<% } %>
								</div>
							</div>
						</div>
					<% } %>
				<% } %>
			</div>
			

			<!-- Load more -->
			<!-- <div class="flex-c-m flex-w w-full p-t-45">
				<a href="#" class="flex-c-m stext-101 cl5 size-103 bg2 bor1 hov-btn1 p-lr-15 trans-04">
					Load More
				</a>
			</div> -->
		</div>
	</section>


	<!-- Footer -->
	<%- include('./partials/userFooter.ejs') %>
		<!-- Footer End -->


		<!-- Back to top -->
		<div class="btn-back-to-top" id="myBtn">
			<span class="symbol-btn-back-to-top">
				<i class="zmdi zmdi-chevron-up"></i>
			</span>
		</div>

		<!-- Modal1 -->
		
		<!--===============================================================================================-->
		<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/animsition/js/animsition.min.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/bootstrap/js/popper.js"></script>
		<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/select2/select2.min.js"></script>
		<script>
			$(".js-select2").each(function () {
				$(this).select2({
					minimumResultsForSearch: 20,
					dropdownParent: $(this).next('.dropDownSelect2')
				});
			})
		</script>
		<!--===============================================================================================-->
		<script src="vendor/daterangepicker/moment.min.js"></script>
		<script src="vendor/daterangepicker/daterangepicker.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/slick/slick.min.js"></script>
		<script src="js/slick-custom.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/parallax100/parallax100.js"></script>
		<script>
			$('.parallax100').parallax100();
		</script>
		<!--===============================================================================================-->
		<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
		<script>
			$('.gallery-lb').each(function () { // the containers for all your galleries
				$(this).magnificPopup({
					delegate: 'a', // the selector for gallery item
					type: 'image',
					gallery: {
						enabled: true
					},
					mainClass: 'mfp-fade'
				});
			});
		</script>
		<!--===============================================================================================-->
		<script src="vendor/isotope/isotope.pkgd.min.js"></script>
		<!--===============================================================================================-->
		<script src="vendor/sweetalert/sweetalert.min.js"></script>
		<script>
			// $('.js-addwish-b2').on('click', function(e){
			// 	e.preventDefault();
			// });

			// $('.js-addwish-b2').each(function(){
			// 	var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
			// 	$(this).on('click', function(){
			// 		swal(nameProduct, "is added to wishlist !", "success");

			// 		$(this).addClass('js-addedwish-b2');
			// 		$(this).off('click');
			// 	});
			// });

			// $('.js-addwish-detail').each(function(){
			// 	var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();

			// 	$(this).on('click', function(){
			// 		swal(nameProduct, "is added to wishlist !", "success");

			// 		$(this).addClass('js-addedwish-detail');
			// 		$(this).off('click');
			// 	});
			// });

			/*---------------------------------------------*/

			// $('.js-addcart-detail').each(function(){
			// 	var nameProduct = $(this).parent().parent().parent().parent().find('.js-name-detail').html();
			// 	$(this).on('click', function(){
			// 		swal(nameProduct, "is added to cart !", "success");
			// 	});
			// });

		</script>
		<!--===============================================================================================-->
		<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
		<script>
			$('.js-pscroll').each(function () {
				$(this).css('position', 'relative');
				$(this).css('overflow', 'hidden');
				var ps = new PerfectScrollbar(this, {
					wheelSpeed: 1,
					scrollingThreshold: 1000,
					wheelPropagation: false,
				});

				$(window).on('resize', function () {
					ps.update();
				})
			});
		</script>
		<!--===============================================================================================-->
		<script src="js/main.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function toggleWishList(productId) {
        // console.log("Toggling wishlist...");

        fetch('/toggleWishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ productId: productId })
        })
        .then(response => response.json())
        .then(data => {
            // console.log("Response Data:", data); 
            const button = document.querySelector(`.js-addwish-b2[data-product-id="${productId}"]`);
            const icon = button.querySelector('i');

            if (data.success) {
             
                if (data.action === 'added') {
                    button.classList.add('active');
                    icon.classList.remove('bi-heart');
                    icon.classList.add('bi-heart-fill');
                    Swal.fire({
                        icon: 'success',
                        title: 'Success!',
                        text: data.message || 'Product added to wishlist successfully',
                        confirmButtonText: 'OK'
                    }).then(() => {
                      
                        window.location.reload();
                    });
                } else {
                    button.classList.remove('active');
                    icon.classList.remove('bi-heart-fill'); 
                    icon.classList.add('bi-heart'); 
                    Swal.fire({
                        icon: 'success',
                        title: 'Removed!',
                        text: data.message || 'Product removed from wishlist successfully',
                        confirmButtonText: 'OK'
                    }).then(() => {
                        
                        window.location.reload();
                    });
                }
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: data.message || 'Failed to update wishlist',
                    confirmButtonText: 'OK'
                });
            }
        })
        .catch(error => {
            console.error('Error:', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'An error occurred while updating the wishlist',
                confirmButtonText: 'OK'
            });
        });
    }
</script>



</body>

</html>